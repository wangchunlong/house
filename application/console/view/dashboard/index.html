{extend name="template/index" /}

{block name="css"}
<link href="__CONSOLE__/css/morris.css" rel="stylesheet">
{/block}

{block name="content"}
<div class="row">

    <div class="col-sm-6 col-md-3">
        <div class="panel panel-success panel-stat">
            <div class="panel-heading">

                <div class="stat">
                    <div class="row">
                        <div class="col-xs-4">
                            <img src="__CONSOLE__/images/is-user.png" alt=""/>
                        </div>
                        <div class="col-xs  -8">
                            <h1>{$user_count}</h1>
                        </div>
                    </div><!-- row -->
                    <div class="mb15"></div>
                    <div class="row">
                        <div class="col-xs-12">
                            <h4>注册会员</h4>
                        </div>
                    </div><!-- row -->
                </div><!-- stat -->

            </div><!-- panel-heading -->
        </div><!-- panel -->
    </div><!-- col-sm-6 -->

    <div class="col-sm-6 col-md-3">
        <div class="panel panel-danger panel-stat">
            <div class="panel-heading">

                <div class="stat">
                    <div class="row">
                        <div class="col-xs-4">
                            <img src="__CONSOLE__/images/is-document.png" alt=""/>
                        </div>
                        <div class="col-xs-8">
                            <h1>{$goods_count}</h1>
                        </div>
                    </div><!-- row -->
                    <div class="mb15"></div>
                    <div class="row">
                        <div class="col-xs-12">
                            <h4>商品数量</h4>
                        </div>
                    </div><!-- row -->
                </div><!-- stat -->

            </div><!-- panel-heading -->
        </div><!-- panel -->
    </div><!-- col-sm-6 -->

    <div class="col-sm-6 col-md-3">
        <div class="panel panel-primary panel-stat">
            <div class="panel-heading">

                <div class="stat">
                    <div class="row">
                        <div class="col-xs-4">
                            <img src="__CONSOLE__/images/is-document.png" alt=""/>
                        </div>
                        <div class="col-xs-8">
                            <h1>{$order_count}</h1>
                        </div>
                    </div><!-- row -->
                    <div class="mb15"></div>
                    <div class="row">
                        <div class="col-xs-12">
                            <h4>订单数量</h4>
                        </div>
                    </div><!-- row -->
                </div><!-- stat -->

            </div><!-- panel-heading -->
        </div><!-- panel -->
    </div><!-- col-sm-6 -->

    <div class="col-sm-6 col-md-3">
        <div class="panel panel-dark panel-stat">
            <div class="panel-heading">
                <div class="stat">
                    <div class="row">
                        <div class="col-xs-4">
                            <img src="__CONSOLE__/images/is-money.png" alt=""/>
                        </div>
                        <div class="col-xs-8">
                            <h1>{$shop_count}</h1>
                        </div>
                    </div><!-- row -->
                    <div class="mb15"></div>
                    <div class="row">
                        <div class="col-xs-12">
                            <h4>店铺数量</h4>
                        </div>
                    </div><!-- row -->
                </div><!-- stat -->
            </div><!-- panel-heading -->
        </div><!-- panel -->
    </div><!-- col-sm-6 -->
</div><!-- row -->


<!--<div class="row">

    <div class="col-sm-6">
        <div class="panel panel-default">
            <div class="panel-heading">
                <h4 class="panel-title">热卖商品销量统计</h4>
            </div>

            <div class="panel-body">
                <div id="barchart" style="width: 100%; height: 300px"></div>
            </div>
        </div>
    </div>

    <div class="col-sm-6">
        <div class="panel panel-default">
            <div class="panel-heading">
                <h4 class="panel-title">商城收益走势图</h4>
            </div>

            <div class="panel-body">
                <div id="basicflot" style="width: 100%; height: 300px"></div>
            </div>
        </div>
    </div>
</div><!-- row -->


<div class="row">
    <div class="col-sm-6">
        <div class="panel panel-default">
            <div class="panel-heading">
                <h4 class="panel-title">服务器信息</h4>
            </div>
            <div class="panel-body">
                <div class="table-responsive">
                    <table class="table table-striped table-bordered table-hover text-center">
                        <tbody>
                        {volist name="system_info" id="vo"}
                        <tr>
                            <td style="width:20%;text-align: right">{$key}</td>
                            <td style="width:80%;text-align: left">{$vo}</td>
                        </tr>
                        {/volist}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <div class="col-sm-6">
        <div class="panel panel-default">
            <div class="panel-heading">
                <h4 class="panel-title">服务器信息</h4>
            </div>

            <div class="panel-body">
                <div class="table-responsive">
                    <table class="table table-striped table-bordered table-hover text-center">
                        <tbody>
                        {volist name="system_info2" id="vo"}
                        <tr>
                            <td style="width:20%;text-align: right">{$key}</td>
                            <td style="width:80%;text-align: left">{$vo}</td>
                        </tr>
                        {/volist}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>

{/block}

{block name="js"}
<script src="__CONSOLE__/js/flot/jquery.flot.min.js"></script>
<script src="__CONSOLE__/js/flot/jquery.flot.resize.min.js"></script>
<script src="__CONSOLE__/js/flot/jquery.flot.symbol.min.js"></script>
<script src="__CONSOLE__/js/flot/jquery.flot.crosshair.min.js"></script>
<script src="__CONSOLE__/js/flot/jquery.flot.categories.min.js"></script>
<script src="__CONSOLE__/js/flot/jquery.flot.pie.min.js"></script>


{/block}

{block name="script"}
<script>
    jQuery(document).ready(function () {


        /***** 热卖商品销量统计 *****/
        var bardata = [["Jan", 10], ["Feb", 23], ["Mar", 18], ["Apr", 13], ["May", 17], ["Jun", 30], ["Jul", 26], ["Aug", 16], ["Sep", 17], ["Oct", 5], ["Nov", 8], ["Dec", 15]];

        jQuery.plot("#barchart", [bardata], {
            series: {
                lines: {
                    lineWidth: 1
                },
                bars: {
                    show: true,
                    barWidth: 0.5,
                    align: "center",
                    lineWidth: 0,
                    fillColor: "#428BCA"
                }
            },
            grid: {
                borderColor: '#ddd',
                borderWidth: 1,
                labelMargin: 10
            },
            xaxis: {
                mode: "categories",
                tickLength: 0
            }
        });


        /***** 用户访问统计 *****/

        var data = [], totalPoints = 50;

        function getRandomData() {

            if (data.length > 0)
                data = data.slice(1);

            // Do a random walk
            while (data.length < totalPoints) {

                var prev = data.length > 0 ? data[data.length - 1] : 50,
                    y = prev + Math.random() * 10 - 5;

                if (y < 0) {
                    y = 0;
                } else if (y > 100) {
                    y = 100;
                }
                data.push(y);
            }

            // Zip the generated y values with the x values
            var res = [];
            for (var i = 0; i < data.length; ++i) {
                res.push([i, data[i]])
            }
            return res;
        }


        // Set up the control widget
        var updateInterval = 1000;

        var plot4 = jQuery.plot("#realtimechart", [getRandomData()], {
            colors: ["#F0AD4E"],
            series: {
                lines: {
                    fill: true,
                    lineWidth: 0
                },
                shadowSize: 0	// Drawing is faster without shadows
            },
            grid: {
                borderColor: '#ddd',
                borderWidth: 1,
                labelMargin: 10
            },
            xaxis: {
                color: '#eee'
            },
            yaxis: {
                min: 0,
                max: 100,
                color: '#eee'
            }
        });

        function update() {

            plot4.setData([getRandomData()]);

            // Since the axes don't change, we don't need to call plot.setupGrid()
            plot4.draw();
            setTimeout(update, updateInterval);
        }

        update();


        /***** 用户活跃地区统计 *****/

        var piedata = [
            {label: "Series 1", data: [[1, 10]], color: '#D9534F'},
            {label: "Series 2", data: [[1, 30]], color: '#1CAF9A'},
            {label: "Series 3", data: [[1, 90]], color: '#F0AD4E'},
            {label: "Series 4", data: [[1, 70]], color: '#428BCA'},
            {label: "Series 5", data: [[1, 80]], color: '#5BC0DE'}
        ];

        jQuery.plot('#piechart', piedata, {
            series: {
                pie: {
                    show: true,
                    radius: 1,
                    label: {
                        show: true,
                        radius: 2 / 3,
                        formatter: labelFormatter,
                        threshold: 0.1
                    }
                }
            },
            grid: {
                hoverable: true,
                clickable: true
            }
        });

        function labelFormatter(label, series) {
            return "<div style='font-size:8pt; text-align:center; padding:2px; color:white;'>" + label + "<br/>" + Math.round(series.percent) + "%</div>";
        }


        /*****商城收益走势图*****/

        var flash = [[0, 2], [1, 6], [2, 3], [3, 8], [4, 5], [5, 13], [6, 8]];
        var html5 = [[0, 5], [1, 4], [2, 4], [3, 1], [4, 9], [5, 10], [6, 13]];

        var plot = jQuery.plot(jQuery("#basicflot"),
            [{
                data: flash,
                label: "Flash",
                color: "#1CAF9A"
            },
                {
                    data: html5,
                    label: "HTML5",
                    color: "#428BCA"
                }
            ],
            {
                series: {
                    lines: {
                        show: true,
                        fill: true,
                        lineWidth: 1,
                        fillColor: {
                            colors: [{opacity: 0.5},
                                {opacity: 0.5}
                            ]
                        }
                    },
                    points: {
                        show: true
                    },
                    shadowSize: 0
                },
                legend: {
                    position: 'nw'
                },
                grid: {
                    hoverable: true,
                    clickable: true,
                    borderColor: '#ddd',
                    borderWidth: 1,
                    labelMargin: 10,
                    backgroundColor: '#fff'
                },
                yaxis: {
                    min: 0,
                    max: 15,
                    color: '#eee'
                },
                xaxis: {
                    color: '#eee'
                }
            });

        var previousPoint = null;
        jQuery("#basicflot").bind("plothover", function (event, pos, item) {
            jQuery("#x").text(pos.x.toFixed(2));
            jQuery("#y").text(pos.y.toFixed(2));

            if (item) {
                if (previousPoint != item.dataIndex) {
                    previousPoint = item.dataIndex;

                    jQuery("#tooltip").remove();
                    var x = item.datapoint[0].toFixed(2),
                        y = item.datapoint[1].toFixed(2);

                    showTooltip(item.pageX, item.pageY,
                        item.series.label + " of " + x + " = " + y);
                }

            } else {
                jQuery("#tooltip").remove();
                previousPoint = null;
            }

        });

        jQuery("#basicflot").bind("plotclick", function (event, pos, item) {
            if (item) {
                plot.highlight(item.series, item.datapoint);
            }
        });

    });
</script>
{/block}